<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:lang="http://www.springframework.org/schema/lang"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xmlns:util="http://www.springframework.org/schema/util"
       xmlns:p="http://www.springframework.org/schema/p"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
       http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd
       http://www.springframework.org/schema/lang http://www.springframework.org/schema/lang/spring-lang-3.0.xsd
       http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd
       http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.0.xsd">

	<context:component-scan base-package="com.flurdy.grid.snaps" />

	<context:annotation-config />

    <util:map id="configurationMap">
        <entry key="analyticsId" value="${analyticsId}"/>
        <entry key="flickrApiKey" value="${flickrApiKey}"/>
    </util:map>

    <bean id="passwordEncoder" class="org.springframework.security.authentication.encoding.ShaPasswordEncoder" />

    <bean id="mailSender" class="org.springframework.mail.javamail.JavaMailSenderImpl">
        <property name="host" value="localhost"/>
    </bean>

      <bean id="emailService" class="com.flurdy.grid.snaps.service.EmailService"
            p:sendEmails="${email.send}"
            p:sendRegistrationNotification="${email.notification}" 
            p:snapsURL="${snapsURL}"
            p:fromAddress="noreply@snaps.flurdy.com"
            p:passwordTextSubject="Snaps login assistance"
            p:registrationNotificationTextSubject="Snaps registration notification">
        <property name="passwordTextTemplate">
            <value><![CDATA[
                Hi [[fullname]],

                Your password has been reset as requested.

                Please login to snaps via [[snapsURL]]


                with this password: [[password]]


                ----

                This was an automated email sent on behalf of snaps, a photo aggregator.
                For more information on snaps visit http://code.flurdy.com/grid/snaps

                ----

                If you did not request this reset, please do not worry.
                The password was generated randomly by the system
                and has not been shown to anyone else apart from you in this email.

                However please do let us know via http://flurdy.com/contact/
                so that we can investigate and monitor.

                ----


            ]]></value>
        </property>
        <property name="registrationNotificationTextTemplate">
            <value><![CDATA[
                Hi,

                A new traveller has registered for snaps!

                Registration details:

                    fullname:   [[fullname]]
                    username:   [[username]]
                    email:      [[email]]


                The traveller is now welcome at [[snapsURL]]

                ----

                This was an automated email sent on behalf of snaps, a photo aggregator.
                For more information on snaps visit http://code.flurdy.com/grid/snaps

                ----


            ]]></value>
        </property>
    </bean>

</beans>